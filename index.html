<!-- Pandomim Cafe - Fal & Çark & İltifat Sistemi -->
<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pandomim Cafe - Fal & Çark & İltifat</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h2>"Bugün harika bir gün olabilir, yeter ki sen iste."</h2>
  <button id="motiveBtn">Bir güzel söze daha ihtiyacım var</button>

  <div class="wheel-container">
    <img src="logo_resized.png" class="side-logo left-logo" alt="Logo">
    <div class="pointer"></div>
    <canvas id="wheel" width="500" height="500"></canvas>
    <img src="logo_resized.png" class="side-logo right-logo" alt="Logo">
  </div>

  <button id="spinButton">Çevir!</button>

  <p class="info-text">
    Tüm hediyeler için <strong>Instagram hesabımızı takip edin</strong> ve
    <strong>DM'den ekran görüntüsü gönderin</strong>. Her cihaz yalnızca <strong>haftada 2 kez</strong> çark çevirebilir.
  </p>

  <a href="https://instagram.com/pandomimcafe" class="insta-btn" target="_blank">Instagram'a Git</a>

  <script src="script.js"></script>
  <!-- Google Form'a kayıt fonksiyonu -->
  <script>
    function sendToGoogleForm(fingerprint, prize) {
      const formUrl = "https://docs.google.com/forms/d/e/1FAIpQLSdfW5PhEGl6ZqPe_2sfEDfna4avosXflrHQOClzpskmrwW3Tw/formResponse";

      const now = new Date();
      const formattedDate = now.toLocaleDateString('tr-TR');
      const formattedTime = now.toLocaleTimeString('tr-TR');

      const formData = new URLSearchParams();
      formData.append("entry.199924831", fingerprint);
      formData.append("entry.1632524683", `${formattedDate} ${formattedTime}`);
      formData.append("entry.1942271647", prize);

      fetch(formUrl, {
        method: "POST",
        mode: "no-cors",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded"
        },
        body: formData
      });
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js"></script>
  <script>
    let fingerprint = "bilinmiyor";
    FingerprintJS.load().then(fp => {
      fp.get().then(result => {
        fingerprint = result.visitorId;
        window.fingerprintReady = true;
      });
    });

    function checkAndSendPrize(prize) {
      const waitForFP = setInterval(() => {
        if (window.fingerprintReady && fingerprint !== "bilinmiyor") {
          clearInterval(waitForFP);
          sendToGoogleForm(fingerprint, prize);
        }
      }, 100);
    }
  </script>
</body>
</html>
